plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.background = element_rect(fill = "transparent", colour = NA_character_),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Acres impacted per 1000 population, by Tract type") +  ylim(c(0, 4.5))
p2 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "acre_per_cap_1k...9"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# color = "grey", fill = "orange") + # Assuming you want both fill and border in orange for simplicity
#
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "3.94"), vjust = -0.5, position = position_dodge(width = 0.1)) +
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "1.68"), vjust = -0.5, position = position_dodge(width = 0.1)) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B"),
) +
# guides(fill = guide_legend(override.aes = list(shape = 22, size = 6, color = "black")))+ # Here we override the aesthetics for the legend
labs(x = "Tract Status", y = "Mean Acres per 1000 people") +
theme(
axis.text.x =element_text(size = 9, angle = 45, hjust = 1),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.title = element_text(size = 16, margin(b = 20)),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.background = element_rect(fill = "transparent", colour = NA_character_),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Acres impacted per 1000 population, by Tract type") +  ylim(c(0, 4.5))
p2
p2 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "acre_per_cap_1k...9"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# color = "grey", fill = "orange") + # Assuming you want both fill and border in orange for simplicity
#
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "3.94"), vjust = -0.5, position = position_dodge(width = 0.1)) +
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "1.68"), vjust = -0.5, position = position_dodge(width = 0.1)) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B"),
) +
# guides(fill = guide_legend(override.aes = list(shape = 22, size = 6, color = "black")))+ # Here we override the aesthetics for the legend
labs(x = "Tract Status", y = "Mean Acres per 1000 people") +
theme(
axis.text.x =element_text(size = 9,  hjust = 1),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.title = element_text(size = 16, margin(b = 20)),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.background = element_rect(fill = "transparent", colour = NA_character_),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Acres impacted per 1000 population, by Tract type") +  ylim(c(0, 4.5))
p2
p2 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "acre_per_cap_1k...9"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# color = "grey", fill = "orange") + # Assuming you want both fill and border in orange for simplicity
#
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "3.94"), vjust = -0.5, position = position_dodge(width = 0.1)) +
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "1.68"), vjust = -0.5, position = position_dodge(width = 0.1)) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B"),
) +
# guides(fill = guide_legend(override.aes = list(shape = 22, size = 6, color = "black")))+ # Here we override the aesthetics for the legend
labs(x = "Tract Status", y = "Mean Acres per 1000 people") +
theme(
axis.text.x =element_text(size = 9),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.title = element_text(size = 16, margin(b = 20)),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.background = element_rect(fill = "transparent", colour = NA_character_),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Acres impacted per 1000 population, by Tract type") +  ylim(c(0, 4.5))
p2
p2 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "acre_per_cap_1k...9"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# color = "grey", fill = "orange") + # Assuming you want both fill and border in orange for simplicity
#
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "3.94"), vjust = -0.5, position = position_dodge(width = 0.1)) +
geom_text(data = df %>% filter(category == "acre_per_cap_1k...9" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "1.68"), vjust = -0.5, position = position_dodge(width = 0.1)) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B"),
) +
# guides(fill = guide_legend(override.aes = list(shape = 22, size = 6, color = "black")))+ # Here we override the aesthetics for the legend
labs(x = "Tract Status", y = "Mean Acres per 1000 people") +
theme(
axis.text.x =element_text(size = 9),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.title = element_text(size = 14, margin(b = 20)),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.background = element_rect(fill = "transparent", colour = NA_character_),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Acres impacted per 1000 population, by Tract type") +  ylim(c(0, 4.5))
p2
ggsave("images/barplot_acres.png", plot = p2, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = 0), width = .5) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = 0), width = .5) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = 0), width = .5) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = 0), width = .5) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 10),
plot.title = element_text(face = "bold", size = 16),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = 0), width = .5) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = 0), width = .5) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 8),
plot.title = element_text(face = "bold", size = 16),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = 2), width = .5) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = 2), width = .5) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 8),
plot.title = element_text(face = "bold", size = 16),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = -0.5)) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = -0.5)) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 8),
plot.title = element_text(face = "bold", size = 16),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = 0)) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = 0)) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 8),
plot.title = element_text(face = "bold", size = 16),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 7)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = "dodge", color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = 0), width = .5) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = 0), width = .5) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 8),
plot.title = element_text(face = "bold", size = 16),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 10)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
# Plot with corrected code for the 3-patch legend
p1 <- ggplot(data = df, aes(x = disadv, y = count, fill = disadv)) +
# Add bar for total projects with specified color, ensuring `disadv` is used as factor
geom_bar(data = df %>% filter(category == "total_projects"),
aes(fill = disadv), stat = "identity", position = position_dodge(width = 2.2), color = "black") +
# geom_chicklet( radius = grid::unit(4, 'mm'), position = "stack",data = df %>% filter(category == "total_projects"),
#                aes(fill = disadv), stat = "identity", color = "black") +
# Overlay bar for total_oil_gas in black, creating a separate entry for "Industrial"
geom_bar(data = df %>% filter(category == "total_oil_gas"),
aes(fill = "Industrial"), stat = "identity",position = "dodge", color = "black") +
# Text labels
# Custom annotations for oil and gas projects
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Disadvantaged"),
aes(x = disadv, y = count, label = "120 (9%)"),
vjust = -0.5, position = position_dodge(width = 0), width = .5) +
geom_text(data = df %>% filter(category == "total_oil_gas" & disadv == "Not Disadvantaged"),
aes(x = disadv, y = count, label = "172 (5%)"),
vjust = -0.5, color='white', position = position_dodge(width = 0), width = .5) +
# geom_text(aes(label = count), vjust = -0.5, position = position_dodge(width = 0.9)) +
# Manually define the legend with updated labels and colors
scale_fill_manual(
name = "Tract+Project type",
values = c("Disadvantaged" = "#F45D01", "Not Disadvantaged" = "#333C6B", "Industrial" = "#C5C5C5"),
labels = c("Not DA tract, non-industrial",  "Both, Industrial", "DA tract, non-industrial" )
) +
labs(x = "Tract Status", y = "Total Projects") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 8),
plot.title = element_text(face = "bold", size = 16),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 10),
plot.margin = margin(5.5, 40, 5.5, 5.5),
plot.background = element_rect(fill = "transparent", colour = NA_character_),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position = "right",
# legend.box.background = element_rect(color = "black", fill = NA),
legend.background = element_blank(),
axis.title.x = element_text(margin = margin(t = 10)),
# panel.border = element_rect(color = "black", fill = NA, size = .1)
) +
ggtitle("Project category by Tract Disadvantage Status")
p1
ggsave("barplot_counts.png", plot = p1, dpi = 300)  # Adjust dpi as needed
